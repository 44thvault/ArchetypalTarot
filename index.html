<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ARCHETYPAL TAROT ‚Äî Symbolic Mirror</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Silkscreen:wght@400;700&display=swap');

:root {
  --bg-deep: #0a0008;
  --bg-mid: #120010;
  --crimson: #8b1a1a;
  --crimson-glow: #c43c3c;
  --gold: #d4a843;
  --gold-dim: #8a6d2b;
  --text-main: #e8dcc8;
  --text-dim: #7a6e5c;
  --text-bright: #fff8e7;
  --arcane-blue: #2a3a6a;
  --arcane-teal: #1a4a4a;
  --shadow-purple: #3a1a4a;
  --star-silver: #b8c4d0;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

html, body {
  width: 100%; height: 100%;
  overflow: hidden;
  background: var(--bg-deep);
  font-family: 'Silkscreen', monospace;
  color: var(--text-main);
  image-rendering: pixelated;
  -webkit-font-smoothing: none;
}

/* ‚ïê‚ïê‚ïê SCANLINE OVERLAY ‚ïê‚ïê‚ïê */
body::after {
  content: '';
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0,0,0,0.15) 2px,
    rgba(0,0,0,0.15) 4px
  );
  pointer-events: none;
  z-index: 9999;
}

/* ‚ïê‚ïê‚ïê CRT VIGNETTE ‚ïê‚ïê‚ïê */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background: radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.7) 100%);
  pointer-events: none;
  z-index: 9998;
}

/* ‚ïê‚ïê‚ïê BACKGROUND PATTERN ‚ïê‚ïê‚ïê */
#bg-pattern {
  position: fixed;
  inset: 0;
  background:
    radial-gradient(circle at 20% 30%, rgba(139,26,26,0.08) 0%, transparent 50%),
    radial-gradient(circle at 80% 70%, rgba(58,26,74,0.08) 0%, transparent 50%),
    radial-gradient(circle at 50% 50%, rgba(42,58,106,0.05) 0%, transparent 60%);
  z-index: 0;
}

#bg-pattern::after {
  content: '';
  position: absolute;
  inset: 0;
  background-image:
    radial-gradient(1px 1px at 10% 20%, rgba(212,168,67,0.3) 0%, transparent 100%),
    radial-gradient(1px 1px at 30% 60%, rgba(184,196,208,0.2) 0%, transparent 100%),
    radial-gradient(1px 1px at 50% 10%, rgba(212,168,67,0.15) 0%, transparent 100%),
    radial-gradient(1px 1px at 70% 80%, rgba(184,196,208,0.25) 0%, transparent 100%),
    radial-gradient(1px 1px at 90% 40%, rgba(212,168,67,0.2) 0%, transparent 100%),
    radial-gradient(1px 1px at 15% 85%, rgba(184,196,208,0.15) 0%, transparent 100%),
    radial-gradient(1px 1px at 85% 15%, rgba(212,168,67,0.25) 0%, transparent 100%);
  animation: starTwinkle 8s ease-in-out infinite alternate;
}

@keyframes starTwinkle {
  0% { opacity: 0.4; }
  50% { opacity: 1; }
  100% { opacity: 0.6; }
}

/* ‚ïê‚ïê‚ïê MAIN CONTAINER ‚ïê‚ïê‚ïê */
#app {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 1;
}

/* ‚ïê‚ïê‚ïê SCREENS ‚ïê‚ïê‚ïê */
.screen {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  padding: 20px;
}
.screen.active { display: flex; }

/* ‚ïê‚ïê‚ïê TITLE SCREEN ‚ïê‚ïê‚ïê */
#title-screen {
  gap: 24px;
  text-align: center;
}

.title-ornament {
  color: var(--gold-dim);
  font-size: 10px;
  letter-spacing: 8px;
  opacity: 0;
  animation: fadeSlideUp 1.5s ease forwards 0.2s;
}

.game-title {
  font-family: 'Press Start 2P', monospace;
  font-size: clamp(18px, 4vw, 36px);
  color: var(--gold);
  text-shadow:
    0 0 20px rgba(212,168,67,0.4),
    0 2px 0 #6a4a1a,
    0 4px 0 #4a3210;
  letter-spacing: 4px;
  opacity: 0;
  animation: fadeSlideUp 1.5s ease forwards 0.5s;
}

.title-subtitle {
  font-size: 10px;
  color: var(--text-dim);
  letter-spacing: 6px;
  text-transform: uppercase;
  opacity: 0;
  animation: fadeSlideUp 1.5s ease forwards 0.8s;
}

.title-sigil {
  width: 80px;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--gold-dim), transparent);
  opacity: 0;
  animation: fadeSlideUp 1.5s ease forwards 1s;
}

.title-desc {
  font-size: 10px;
  color: var(--text-dim);
  line-height: 2;
  max-width: 480px;
  opacity: 0;
  animation: fadeSlideUp 1.5s ease forwards 1.2s;
}

.start-btn {
  font-family: 'Press Start 2P', monospace;
  font-size: 12px;
  color: var(--gold);
  background: none;
  border: 1px solid var(--gold-dim);
  padding: 14px 40px;
  cursor: pointer;
  letter-spacing: 3px;
  position: relative;
  opacity: 0;
  animation: fadeSlideUp 1.5s ease forwards 1.6s;
  transition: all 0.3s;
}
.start-btn:hover {
  background: rgba(212,168,67,0.1);
  border-color: var(--gold);
  text-shadow: 0 0 12px rgba(212,168,67,0.5);
}
.start-btn::before {
  content: '‚ñ∂';
  position: absolute;
  left: 14px;
  animation: blink 1.2s step-end infinite;
}

@keyframes blink { 50% { opacity: 0; } }
@keyframes fadeSlideUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ‚ïê‚ïê‚ïê SPREAD SCREEN ‚ïê‚ïê‚ïê */
#spread-screen {
  gap: 20px;
}

.spread-header {
  text-align: center;
  opacity: 0;
  animation: fadeSlideUp 0.8s ease forwards;
}
.spread-header h2 {
  font-family: 'Press Start 2P', monospace;
  font-size: 11px;
  color: var(--gold);
  letter-spacing: 3px;
  margin-bottom: 8px;
}
.spread-header p {
  font-size: 9px;
  color: var(--text-dim);
  letter-spacing: 2px;
}

.spread-labels {
  display: flex;
  gap: clamp(20px, 6vw, 60px);
  margin-bottom: -8px;
}
.spread-label {
  text-align: center;
  font-size: 8px;
  color: var(--text-dim);
  letter-spacing: 1px;
  width: clamp(80px, 18vw, 140px);
  opacity: 0;
  animation: fadeSlideUp 0.6s ease forwards;
}
.spread-label:nth-child(1) { animation-delay: 0.3s; }
.spread-label:nth-child(2) { animation-delay: 0.5s; }
.spread-label:nth-child(3) { animation-delay: 0.7s; }
.spread-label .label-num {
  font-family: 'Press Start 2P', monospace;
  font-size: 10px;
  color: var(--gold-dim);
  display: block;
  margin-bottom: 4px;
}

.card-spread {
  display: flex;
  gap: clamp(20px, 6vw, 60px);
  perspective: 800px;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CARD FLIP ‚Äî ROCK SOLID POSITIONING
   
   card-slot: fixed width/height container
   card-inner: absolute, fills slot, does the 3D flip
   card-face (back & front): absolute, pinned top:0 left:0
   
   Nothing uses flexbox stretching. Nothing shifts.
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

.card-slot {
  width: clamp(80px, 18vw, 140px);
  height: clamp(120px, 27vw, 210px);
  position: relative;
  cursor: pointer;
  opacity: 0;
  animation: cardAppear 0.8s ease forwards;
}
.card-slot:nth-child(1) { animation-delay: 0.4s; }
.card-slot:nth-child(2) { animation-delay: 0.6s; }
.card-slot:nth-child(3) { animation-delay: 0.8s; }

@keyframes cardAppear {
  from { opacity: 0; transform: translateY(30px) scale(0.9); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

.card-inner {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.card-slot.flipped .card-inner {
  transform: rotateY(180deg);
}

.card-face {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  border-radius: 6px;
  overflow: hidden;
  border: 2px solid var(--gold-dim);
  box-shadow: 0 0 15px rgba(0,0,0,0.6), 0 0 30px rgba(139,26,26,0.15);
}

/* ‚ïê‚ïê‚ïê CARD BACK ‚ïê‚ïê‚ïê */
.card-back {
  background: var(--crimson);
  display: flex;
  align-items: center;
  justify-content: center;
}
.card-back::before {
  content: '';
  position: absolute;
  inset: 6px;
  border: 1px solid rgba(212,168,67,0.3);
  border-radius: 3px;
}
.card-back-pattern {
  width: 60%; height: 60%;
  position: relative;
}
.card-back-diamond {
  position: absolute;
  width: 100%; height: 100%;
  border: 2px solid rgba(212,168,67,0.4);
  transform: rotate(45deg);
}
.card-back-diamond:nth-child(2) {
  width: 70%; height: 70%;
  top: 15%; left: 15%;
  border-color: rgba(212,168,67,0.25);
}
.card-back-diamond:nth-child(3) {
  width: 40%; height: 40%;
  top: 30%; left: 30%;
  border-color: rgba(212,168,67,0.15);
}

/* ‚ïê‚ïê‚ïê CARD FRONT ‚ïê‚ïê‚ïê */
.card-front {
  transform: rotateY(180deg);
  background: var(--bg-mid);
}

/* Pixel art image fills entire card face */
.card-front-img {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
  display: block;
}

/* Fallback when no image loads */
.card-front-fallback {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.card-front-fallback .fb-numeral {
  font-family: 'Press Start 2P', monospace;
  font-size: 7px;
  color: var(--gold-dim);
}
.card-front-fallback .fb-symbol {
  font-size: clamp(28px, 7vw, 48px);
  filter: drop-shadow(0 0 8px rgba(212,168,67,0.3));
}
.card-front-fallback .fb-name {
  font-family: 'Press Start 2P', monospace;
  font-size: clamp(5px, 1.2vw, 7px);
  color: var(--gold);
  text-align: center;
  letter-spacing: 1px;
  padding: 0 4px;
}

/* When image loads successfully, hide fallback */
.card-front.has-image .card-front-fallback { display: none; }

/* Card name label overlaid at bottom of image */
.card-front-label {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  background: linear-gradient(transparent, rgba(0,0,0,0.85));
  padding: 8px 4px 5px;
  text-align: center;
  font-family: 'Press Start 2P', monospace;
  font-size: clamp(4px, 1.1vw, 6px);
  color: var(--gold);
  letter-spacing: 1px;
  display: none;
}
.card-front.has-image .card-front-label { display: block; }

/* ‚ïê‚ïê‚ïê CARD HOVER (only before flip) ‚ïê‚ïê‚ïê */
.card-slot:not(.flipped):hover {
  transform: translateY(-4px);
  transition: transform 0.2s;
}
.card-slot:not(.flipped):hover .card-face {
  border-color: var(--gold);
  box-shadow: 0 0 20px rgba(212,168,67,0.3), 0 0 40px rgba(139,26,26,0.2);
}
.card-slot.flipped { cursor: default; }

.spread-instruction {
  font-size: 9px;
  color: var(--text-dim);
  letter-spacing: 2px;
  opacity: 0;
  animation: fadeSlideUp 0.6s ease forwards 1s;
}
.spread-instruction.hidden { display: none; }

/* ‚ïê‚ïê‚ïê READING BUTTON ‚ïê‚ïê‚ïê */
.read-btn {
  font-family: 'Press Start 2P', monospace;
  font-size: 10px;
  color: var(--gold);
  background: none;
  border: 1px solid var(--gold-dim);
  padding: 12px 32px;
  cursor: pointer;
  letter-spacing: 2px;
  transition: all 0.3s;
  display: none;
}
.read-btn.visible { display: block; animation: fadeSlideUp 0.6s ease forwards; }
.read-btn:hover {
  background: rgba(212,168,67,0.1);
  border-color: var(--gold);
  text-shadow: 0 0 10px rgba(212,168,67,0.4);
}

/* ‚ïê‚ïê‚ïê READING SCREEN ‚ïê‚ïê‚ïê */
#reading-screen {
  overflow-y: auto;
  padding: 30px 20px;
  gap: 0;
  justify-content: flex-start;
  scrollbar-width: thin;
  scrollbar-color: var(--gold-dim) transparent;
}

.reading-container {
  max-width: 600px;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

/* ‚ïê‚ïê‚ïê 16-BIT TEXT BOX ‚ïê‚ïê‚ïê */
.text-box {
  border: 2px solid var(--gold-dim);
  background: rgba(10,0,8,0.92);
  padding: 16px 20px;
  position: relative;
  opacity: 0;
  transform: translateY(10px);
  animation: textBoxReveal 0.6s ease forwards;
}

.text-box::before {
  content: '';
  position: absolute;
  inset: 3px;
  border: 1px solid rgba(212,168,67,0.15);
  pointer-events: none;
}

@keyframes textBoxReveal {
  to { opacity: 1; transform: translateY(0); }
}

.text-box.card-reading:nth-child(1) { animation-delay: 0.2s; }
.text-box.card-reading:nth-child(2) { animation-delay: 0.6s; }
.text-box.card-reading:nth-child(3) { animation-delay: 1.0s; }
.text-box.synthesis-box { animation-delay: 1.6s; }

.tb-position {
  font-size: 8px;
  color: var(--text-dim);
  letter-spacing: 3px;
  text-transform: uppercase;
  margin-bottom: 8px;
}

.tb-card-name {
  font-family: 'Press Start 2P', monospace;
  font-size: clamp(10px, 2.5vw, 14px);
  color: var(--gold);
  text-shadow: 0 0 12px rgba(212,168,67,0.3);
  margin-bottom: 4px;
}

.tb-numeral {
  font-size: 8px;
  color: var(--gold-dim);
  margin-bottom: 10px;
}

.tb-light {
  font-size: 9px;
  color: var(--star-silver);
  line-height: 1.8;
  margin-bottom: 4px;
}

.tb-shadow {
  font-size: 9px;
  color: var(--crimson-glow);
  line-height: 1.8;
  margin-bottom: 10px;
}

.tb-reflection {
  font-size: 9px;
  color: var(--gold);
  font-style: italic;
  line-height: 1.8;
  padding-top: 8px;
  border-top: 1px solid rgba(212,168,67,0.15);
}

.tb-divider {
  width: 40px;
  height: 1px;
  background: var(--gold-dim);
  margin: 4px 0 8px;
}

/* SYNTHESIS */
.synthesis-box {
  border-color: var(--gold);
  background: rgba(10,0,8,0.95);
}
.synthesis-box::after {
  content: '';
  position: absolute;
  inset: -1px;
  border: 1px solid rgba(212,168,67,0.08);
  pointer-events: none;
}

.synth-title {
  font-family: 'Press Start 2P', monospace;
  font-size: 10px;
  color: var(--gold);
  letter-spacing: 3px;
  margin-bottom: 12px;
  text-shadow: 0 0 15px rgba(212,168,67,0.3);
}

.synth-text {
  font-size: 10px;
  color: var(--text-bright);
  line-height: 2;
}

.synth-question {
  font-size: 10px;
  color: var(--gold);
  line-height: 2;
  margin-top: 12px;
  padding-top: 10px;
  border-top: 1px solid rgba(212,168,67,0.2);
}

/* ‚ïê‚ïê‚ïê AGAIN BUTTON ‚ïê‚ïê‚ïê */
.again-btn {
  font-family: 'Press Start 2P', monospace;
  font-size: 10px;
  color: var(--text-dim);
  background: none;
  border: 1px solid rgba(212,168,67,0.2);
  padding: 12px 32px;
  cursor: pointer;
  letter-spacing: 2px;
  transition: all 0.3s;
  margin-top: 16px;
  opacity: 0;
  animation: fadeSlideUp 0.8s ease forwards 2.2s;
}
.again-btn:hover {
  color: var(--gold);
  border-color: var(--gold-dim);
}

/* ‚ïê‚ïê‚ïê RESPONSIVE ‚ïê‚ïê‚ïê */
@media (max-height: 600px) {
  .title-desc { display: none; }
  .spread-header h2 { font-size: 9px; }
}
@media (max-width: 400px) {
  .card-slot { width: 70px !important; height: 105px !important; }
  .spread-labels { gap: 12px; }
  .card-spread { gap: 12px; }
}
</style>
</head>
<body>

<div id="bg-pattern"></div>

<div id="app">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TITLE SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="title-screen" class="screen active">
    <div class="title-ornament">‚ú¶ ‚ú¶ ‚ú¶</div>
    <h1 class="game-title">ARCHETYPAL<br>TAROT</h1>
    <div class="title-sigil"></div>
    <div class="title-subtitle">SYMBOLIC MIRROR</div>
    <p class="title-desc">
      Not prophecy. Not fortune.<br>
      A mirror of the archetypes within.<br><br>
      Draw three cards.<br>
      Explore what patterns emerge.
    </p>
    <button class="start-btn" onclick="beginReading()">&nbsp; BEGIN &nbsp;</button>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SPREAD SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="spread-screen" class="screen">
    <div class="spread-header">
      <h2>THREE-CARD MIRROR</h2>
      <p>ACTIVE &nbsp;¬∑&nbsp; SHADOW &nbsp;¬∑&nbsp; INTEGRATION</p>
    </div>

    <div class="spread-labels">
      <div class="spread-label">
        <span class="label-num">I</span>
        ACTIVE<br>ARCHETYPE
      </div>
      <div class="spread-label">
        <span class="label-num">II</span>
        SHADOW OR<br>CHALLENGE
      </div>
      <div class="spread-label">
        <span class="label-num">III</span>
        EMERGING<br>POTENTIAL
      </div>
    </div>

    <div class="card-spread" id="card-spread">
      <div class="card-slot" onclick="flipCard(0)">
        <div class="card-inner">
          <div class="card-face card-back">
            <div class="card-back-pattern">
              <div class="card-back-diamond"></div>
              <div class="card-back-diamond"></div>
              <div class="card-back-diamond"></div>
            </div>
          </div>
          <div class="card-face card-front" id="card-front-0"></div>
        </div>
      </div>
      <div class="card-slot" onclick="flipCard(1)">
        <div class="card-inner">
          <div class="card-face card-back">
            <div class="card-back-pattern">
              <div class="card-back-diamond"></div>
              <div class="card-back-diamond"></div>
              <div class="card-back-diamond"></div>
            </div>
          </div>
          <div class="card-face card-front" id="card-front-1"></div>
        </div>
      </div>
      <div class="card-slot" onclick="flipCard(2)">
        <div class="card-inner">
          <div class="card-face card-back">
            <div class="card-back-pattern">
              <div class="card-back-diamond"></div>
              <div class="card-back-diamond"></div>
              <div class="card-back-diamond"></div>
            </div>
          </div>
          <div class="card-face card-front" id="card-front-2"></div>
        </div>
      </div>
    </div>

    <p class="spread-instruction" id="spread-instruction">SELECT A CARD TO REVEAL</p>
    <button class="read-btn" id="read-btn" onclick="showReading()">READ THE MIRROR</button>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê READING SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="reading-screen" class="screen">
    <div class="reading-container" id="reading-container"></div>
  </div>

</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ARCHETYPAL TAROT ‚Äî PSYCHOLOGICAL ENGINE
//
// IMAGE FILES:  cards/1.png  ‚Üí  cards/22.png
//
//   1.png  = The Fool       (id 0)
//   2.png  = The Magician    (id 1)
//   3.png  = The High Priestess (id 2)
//   4.png  = The Empress     (id 3)
//   5.png  = The Emperor     (id 4)
//   6.png  = The Hierophant  (id 5)
//   7.png  = The Lovers      (id 6)
//   8.png  = The Chariot     (id 7)
//   9.png  = Strength        (id 8)
//   10.png = The Hermit      (id 9)
//   11.png = Wheel of Fortune (id 10)
//   12.png = Justice         (id 11)
//   13.png = The Hanged One  (id 12)
//   14.png = Death           (id 13)
//   15.png = Temperance      (id 14)
//   16.png = The Devil       (id 15)
//   17.png = The Tower       (id 16)
//   18.png = The Star        (id 17)
//   19.png = The Moon        (id 18)
//   20.png = The Sun         (id 19)
//   21.png = Judgement       (id 20)
//   22.png = The World       (id 21)
//
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function cardImagePath(cardId) {
  return 'cards/' + (cardId + 1) + '.png';
}

const ARCANA = [
  {
    id: 0, numeral: "0", name: "THE FOOL",
    symbol: "üåÄ",
    archetype: "The Innocent Wanderer",
    light16: "Pure beginning. No map.\nThe road opens. You step.",
    shadow16: "Blind trust. Refusal to see\nthe edge beneath your feet.",
    reflections: [
      "What are you afraid to begin?",
      "Where does trust become avoidance?",
      "What would you do if failure were impossible?"
    ]
  },
  {
    id: 1, numeral: "I", name: "THE MAGICIAN",
    symbol: "‚úß",
    archetype: "The Conscious Will",
    light16: "All tools are present.\nWill shapes the world.\nFocus. Create.",
    shadow16: "Clever hands. Empty heart.\nPower without purpose deceives.",
    reflections: [
      "What skill are you not yet using?",
      "Where does cleverness replace honesty?",
      "What would you create if you trusted your ability?"
    ]
  },
  {
    id: 2, numeral: "II", name: "THE HIGH PRIESTESS",
    symbol: "‚òΩ",
    archetype: "The Unconscious Depth",
    light16: "Silence holds answers.\nBeneath the surface ‚Äî knowing.\nBe still. Listen.",
    shadow16: "Hidden behind the veil.\nKnowing ‚Äî but refusing to speak.",
    reflections: [
      "What do you already know but haven't admitted?",
      "What truth lives beneath your thinking?",
      "Where does silence protect ‚Äî and where does it imprison?"
    ]
  },
  {
    id: 3, numeral: "III", name: "THE EMPRESS",
    symbol: "‚ùÄ",
    archetype: "The Creative Mother",
    light16: "Life grows where you tend.\nAbundance. Warmth. Creation\nflows through open hands.",
    shadow16: "Giving until empty.\nNurture becomes a cage.\nWho tends the tender?",
    reflections: [
      "What are you nurturing ‚Äî and what nurtures you?",
      "Where does generosity become self-erasure?",
      "What is ready to be born through you?"
    ]
  },
  {
    id: 4, numeral: "IV", name: "THE EMPEROR",
    symbol: "‚ôî",
    archetype: "The Sovereign Structure",
    light16: "Order serves the living.\nBoundaries protect. Structure\ngives shape to the shapeless.",
    shadow16: "The throne hardens.\nControl replaces care.\nWalls become prisons.",
    reflections: [
      "Where do you need more structure ‚Äî or less?",
      "Is your authority serving others or yourself?",
      "What boundary needs to be set ‚Äî or dissolved?"
    ]
  },
  {
    id: 5, numeral: "V", name: "THE HIEROPHANT",
    symbol: "‚õä",
    archetype: "The Sacred Teacher",
    light16: "Ancient words carry weight.\nThe path was walked before.\nLearn. Then walk your own.",
    shadow16: "The old rule tightens.\nObedience replaces thought.\nWhose truth do you carry?",
    reflections: [
      "What teaching still serves you ‚Äî and what constrains?",
      "Where do you follow without questioning?",
      "What would your own tradition look like?"
    ]
  },
  {
    id: 6, numeral: "VI", name: "THE LOVERS",
    symbol: "‚ù¶",
    archetype: "The Sacred Choice",
    light16: "Two paths. One heart.\nChoose what reflects your truth.\nLove demands honesty.",
    shadow16: "Fear of loss binds.\nThe choice unmade\nbecomes its own prison.",
    reflections: [
      "What choice are you avoiding ‚Äî and why?",
      "Where does connection require you to be more yourself?",
      "What are you really choosing between?"
    ]
  },
  {
    id: 7, numeral: "VII", name: "THE CHARIOT",
    symbol: "‚öî",
    archetype: "The Directed Will",
    light16: "Two horses pull as one.\nConflict becomes direction.\nForward. Through. Now.",
    shadow16: "Force without feeling.\nVictory becomes violence.\nWhere are you running?",
    reflections: [
      "What opposing forces within you need integration?",
      "Is your momentum purposeful or escapist?",
      "What would healthy discipline look like right now?"
    ]
  },
  {
    id: 8, numeral: "VIII", name: "STRENGTH",
    symbol: "ü¶Å",
    archetype: "The Gentle Power",
    light16: "The lion rests in open hands.\nCourage is not force.\nSoftness holds what fury cannot.",
    shadow16: "Smiling while clenching.\nThe beast is caged, not calmed.\nWhat are you suppressing?",
    reflections: [
      "Where do you mistake control for strength?",
      "What instinct needs compassion, not suppression?",
      "What does your gentlest power feel like?"
    ]
  },
  {
    id: 9, numeral: "IX", name: "THE HERMIT",
    symbol: "üèî",
    archetype: "The Inner Sage",
    light16: "Withdraw. Listen inward.\nThe lamp burns for one.\nTruth waits in silence.",
    shadow16: "Isolation wears the mask\nof wisdom. Alone ‚Äî or hiding?",
    reflections: [
      "What truth waits in your silence?",
      "Is your solitude chosen ‚Äî or defensive?",
      "What inner voice have you been ignoring?"
    ]
  },
  {
    id: 10, numeral: "X", name: "WHEEL OF FORTUNE",
    symbol: "‚ò∏",
    archetype: "The Eternal Cycle",
    light16: "The wheel turns.\nWhat falls will rise.\nRelease the grip. Flow.",
    shadow16: "Spinning without center.\nHelpless within the turning.\nWhere is your stillness?",
    reflections: [
      "What cycle are you within ‚Äî and where in it?",
      "What are you resisting that is already changing?",
      "Where is the still point within the turning?"
    ]
  },
  {
    id: 11, numeral: "XI", name: "JUSTICE",
    symbol: "‚öñ",
    archetype: "The Inner Tribunal",
    light16: "The scales do not lie.\nSee clearly. Without mercy\nor cruelty ‚Äî just truth.",
    shadow16: "Judgment sharpens to blade.\nFairness becomes punishment.\nWho are you punishing?",
    reflections: [
      "What needs honest accounting in your life?",
      "Where does fairness tip into harshness?",
      "What truth are you avoiding through self-judgment?"
    ]
  },
  {
    id: 12, numeral: "XII", name: "THE HANGED ONE",
    symbol: "‚•Ø",
    archetype: "The Sacred Surrender",
    light16: "Suspended. Inverted.\nThe world shifts when you stop\nfighting gravity.",
    shadow16: "Suffering worn as crown.\nSurrender becomes identity.\nAre you letting go ‚Äî or giving up?",
    reflections: [
      "What would you see differently if you stopped struggling?",
      "Where does sacrifice become martyrdom?",
      "What must you release to gain new vision?"
    ]
  },
  {
    id: 13, numeral: "XIII", name: "DEATH",
    symbol: "‚óâ",
    archetype: "The Great Transformer",
    light16: "An ending comes.\nNot punishment ‚Äî passage.\nRelease what is complete.",
    shadow16: "Clinging to the dead.\nThe old form crumbles.\nWhat are you keeping alive\nthat has already gone?",
    reflections: [
      "What is ending ‚Äî and what are you holding past its time?",
      "What new identity waits behind this loss?",
      "What must decompose to feed new growth?"
    ]
  },
  {
    id: 14, numeral: "XIV", name: "TEMPERANCE",
    symbol: "‚è≥",
    archetype: "The Alchemist",
    light16: "Two waters become one.\nThe blend takes time.\nPatience. Integration. Balance.",
    shadow16: "Extremes call louder\nthan the quiet middle.\nWhere have you lost balance?",
    reflections: [
      "What opposites in you are asking to be blended?",
      "Where does impatience sabotage integration?",
      "What would moderation look like ‚Äî without numbness?"
    ]
  },
  {
    id: 15, numeral: "XV", name: "THE DEVIL",
    symbol: "‚õì",
    archetype: "The Binding Shadow",
    light16: "The chains are loose.\nYou could leave ‚Äî but don't.\nName the pattern. See it.",
    shadow16: "Comfortable bondage.\nThe familiar cage feels safe.\nWhat are you addicted to?",
    reflections: [
      "What pattern binds you ‚Äî and what does it protect?",
      "Where does comfort become a cage?",
      "What would you lose if you let this go?"
    ]
  },
  {
    id: 16, numeral: "XVI", name: "THE TOWER",
    symbol: "‚ö°",
    archetype: "The Sudden Revelation",
    light16: "Lightning strikes the crown.\nFalse structure breaks.\nTruth burns ‚Äî but frees.",
    shadow16: "Clinging to rubble.\nThe fall feels like punishment.\nWhat illusion are you defending?",
    reflections: [
      "What structure in your life is built on false ground?",
      "What would liberation look like ‚Äî even if it hurts?",
      "What truth have you been avoiding?"
    ]
  },
  {
    id: 17, numeral: "XVII", name: "THE STAR",
    symbol: "‚ú¶",
    archetype: "The Gentle Renewal",
    light16: "Gentle light returns.\nAfter the fall ‚Äî renewal.\nPour water. Be healed.",
    shadow16: "Hope too fragile to hold.\nThe dark lingers.\nCan you trust the quiet?",
    reflections: [
      "Where is renewal quietly beginning?",
      "What gentle hope are you afraid to trust?",
      "How do you heal ‚Äî and do you let yourself?"
    ]
  },
  {
    id: 18, numeral: "XVIII", name: "THE MOON",
    symbol: "üåô",
    archetype: "The Threshold of Illusion",
    light16: "Moonlight distorts.\nWhat you see may not be real.\nTrust the deeper sense.",
    shadow16: "Shadows become monsters.\nFear writes the story.\nWhat are you imagining\nthat isn't there?",
    reflections: [
      "What fear is distorting your perception?",
      "What truth hides behind the illusion?",
      "Where does imagination serve ‚Äî and where does it deceive?"
    ]
  },
  {
    id: 19, numeral: "XIX", name: "THE SUN",
    symbol: "‚òÄ",
    archetype: "The Radiant Self",
    light16: "Light without hiding.\nThe self shines, unafraid.\nJoy. Warmth. Presence.",
    shadow16: "Smile that hides the ache.\nBrightness that denies the dark.\nIs this joy ‚Äî or performance?",
    reflections: [
      "Where do you feel most yourself?",
      "Is your brightness authentic ‚Äî or performative?",
      "What does genuine joy feel like in your body?"
    ]
  },
  {
    id: 20, numeral: "XX", name: "JUDGEMENT",
    symbol: "üîî",
    archetype: "The Great Awakening",
    light16: "The call sounds.\nRise from what was.\nAll parts of you ‚Äî gather.",
    shadow16: "The call goes unanswered.\nRefusal to rise. Self-judgment\nreplaces self-reckoning.",
    reflections: [
      "What is calling you to rise ‚Äî and what holds you down?",
      "What part of your past needs integration, not rejection?",
      "What would it mean to answer your own call?"
    ]
  },
  {
    id: 21, numeral: "XXI", name: "THE WORLD",
    symbol: "‚óØ",
    archetype: "The Completed Cycle",
    light16: "The circle closes.\nWholeness ‚Äî not perfection.\nDance at the center.",
    shadow16: "Arrival becomes prison.\nThe completed story\nfears its own sequel.",
    reflections: [
      "What cycle is completing in your life?",
      "Can you celebrate arrival without clinging to it?",
      "What new beginning hides within this ending?"
    ]
  }
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SYNTHESIS RULES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const SYNTHESIS_RULES = [
  { pair: [13, 14], theme: "Transformation seeks Integration.", narrative: "What has ended asks to be\nblended ‚Äî not mourned.\nAlchemy follows loss." },
  { pair: [16, 17], theme: "Collapse opens to Renewal.", narrative: "The tower falls. Stars appear.\nDestruction was not the end ‚Äî\nit was the clearing." },
  { pair: [13, 17], theme: "Death feeds the Star.", narrative: "From the compost of the old,\ngentle light returns.\nLoss becomes the soil of hope." },
  { pair: [15, 6], theme: "Attachment versus Authentic Choice.", narrative: "The chains whisper comfort.\nThe heart demands truth.\nWhat do you choose ‚Äî safety or love?" },
  { pair: [1, 2], theme: "Conscious meets Unconscious.", narrative: "The hand that shapes\nand the depth that knows.\nAction and intuition seek balance." },
  { pair: [4, 3], theme: "Structure meets Flow.", narrative: "The throne and the garden.\nOrder and abundance\nseek a living balance." },
  { pair: [9, 19], theme: "Solitude meets Radiance.", narrative: "The lamp in the cave.\nThe sun in the field.\nBoth are light ‚Äî different medicines." },
  { pair: [0, 21], theme: "Beginning meets Completion.", narrative: "The Fool's leap and the World's\ndance ‚Äî the same circle.\nEvery ending seeds a start." },
  { pair: [7, 12], theme: "Will meets Surrender.", narrative: "Charge forward ‚Äî or let go?\nThe warrior and the suspended one\nteach opposing truths." },
  { pair: [8, 15], theme: "Gentle Power meets Shadow Bondage.", narrative: "The lion can be calmed.\nThe chains can be removed.\nBoth require you to look." },
  { pair: [11, 20], theme: "Judgment meets Awakening.", narrative: "The scales measure.\nThe trumpet calls.\nAccountability becomes liberation." },
  { pair: [18, 19], theme: "Illusion meets Clarity.", narrative: "Moonlight and sunlight\nover the same landscape.\nWhat you feared in darkness\nreveals itself in dawn." },
  { pair: [16, 13], theme: "Destruction meets Transformation.", narrative: "Two forces of ending\nconverge. Something profound\nis being dismantled.\nTrust the process." },
  { pair: [5, 0], theme: "Tradition meets the Wanderer.", narrative: "The old path and the pathless.\nWhat was taught\nand what must be discovered." },
  { pair: [10, 21], theme: "The Turning meets Wholeness.", narrative: "Within the spinning ‚Äî\na still center.\nThe cycle approaches completion." },
  { pair: [3, 13], theme: "Creation meets Dissolution.", narrative: "The mother and the reaper.\nLife that gives\nand life that takes away.\nBoth are necessary." },
  { pair: [6, 9], theme: "Connection meets Solitude.", narrative: "To love truly,\none must first be whole alone.\nWithdrawal serves union." },
  { pair: [15, 16], theme: "Bondage before the Break.", narrative: "The chains tighten\nbefore the lightning strikes.\nLiberation comes\nwhen you can no longer endure." },
  { pair: [2, 18], theme: "Depth meets Illusion.", narrative: "The priestess and the moon.\nDeep knowing navigates\nwhat surface seeing cannot." },
  { pair: [1, 15], theme: "Will meets Compulsion.", narrative: "Mastery and addiction\nshare the same root: desire.\nOne is conscious. One is not." }
];

const INTENSIFIERS = {
  13: [16, 15, 10],
  16: [13, 15, 20],
  0: [21, 10],
  8: [2, 11],
  19: [17, 0],
  15: [18, 1],
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// GAME STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let drawnCards = [];
let flippedCount = 0;

function shuffleDeck() {
  const deck = [...Array(22).keys()];
  for (let i = deck.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [deck[i], deck[j]] = [deck[j], deck[i]];
  }
  return deck;
}

function beginReading() {
  const deck = shuffleDeck();
  drawnCards = [deck[0], deck[1], deck[2]];
  flippedCount = 0;

  for (let i = 0; i < 3; i++) {
    const card = ARCANA[drawnCards[i]];
    const front = document.getElementById('card-front-' + i);
    const imgSrc = cardImagePath(card.id);

    // Reset
    front.classList.remove('has-image');

    // Build front contents: image (with fallback) + label
    front.innerHTML =
      '<img class="card-front-img" src="' + imgSrc + '"' +
      ' onload="this.parentElement.classList.add(\'has-image\')"' +
      ' onerror="this.style.display=\'none\'">' +
      '<div class="card-front-fallback">' +
        '<span class="fb-numeral">' + card.numeral + '</span>' +
        '<span class="fb-symbol">' + card.symbol + '</span>' +
        '<span class="fb-name">' + card.name + '</span>' +
      '</div>' +
      '<div class="card-front-label">' + card.name + '</div>';
  }

  document.querySelectorAll('.card-slot').forEach(function(s) {
    s.classList.remove('flipped');
  });
  document.getElementById('read-btn').classList.remove('visible');
  document.getElementById('spread-instruction').classList.remove('hidden');
  document.getElementById('spread-instruction').textContent = 'SELECT A CARD TO REVEAL';

  switchScreen('spread-screen');
}

function flipCard(index) {
  var slot = document.querySelectorAll('.card-slot')[index];
  if (slot.classList.contains('flipped')) return;

  slot.classList.add('flipped');
  flippedCount++;

  if (flippedCount < 3) {
    var remaining = 3 - flippedCount;
    document.getElementById('spread-instruction').textContent =
      remaining === 1 ? 'ONE CARD REMAINS' : remaining + ' CARDS REMAIN';
  } else {
    document.getElementById('spread-instruction').classList.add('hidden');
    setTimeout(function() {
      document.getElementById('read-btn').classList.add('visible');
    }, 400);
  }
}

function switchScreen(id) {
  document.querySelectorAll('.screen').forEach(function(s) {
    s.classList.remove('active');
  });
  document.getElementById(id).classList.add('active');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// READING GENERATOR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function findSynthesisRule(id1, id2) {
  return SYNTHESIS_RULES.find(function(r) {
    return (r.pair[0] === id1 && r.pair[1] === id2) ||
           (r.pair[0] === id2 && r.pair[1] === id1);
  });
}

function isIntensified(id1, id2) {
  return (INTENSIFIERS[id1] && INTENSIFIERS[id1].indexOf(id2) !== -1) ||
         (INTENSIFIERS[id2] && INTENSIFIERS[id2].indexOf(id1) !== -1);
}

function generateSynthesis(cards) {
  var c = cards.map(function(id) { return ARCANA[id]; });

  var pairNarrative = null;
  var pairTheme = null;

  var pairs = [[0,1],[1,2],[0,2]];
  for (var p = 0; p < pairs.length; p++) {
    var rule = findSynthesisRule(cards[pairs[p][0]], cards[pairs[p][1]]);
    if (rule) {
      pairNarrative = rule.narrative;
      pairTheme = rule.theme;
      break;
    }
  }

  var intensified = false;
  for (var q = 0; q < pairs.length; q++) {
    if (isIntensified(cards[pairs[q][0]], cards[pairs[q][1]])) {
      intensified = true;
      break;
    }
  }

  var synthLines = [];

  if (pairTheme) {
    synthLines.push(pairTheme);
    synthLines.push('');
    synthLines.push(pairNarrative);
  } else {
    synthLines.push(c[0].name + ' moves through you.');
    synthLines.push(c[1].name + ' creates tension.');
    synthLines.push(c[2].name + ' holds the key.');
    synthLines.push('');
    synthLines.push('The ' + c[0].archetype.toLowerCase());
    synthLines.push('meets the ' + c[1].archetype.toLowerCase() + '.');
    synthLines.push(c[2].archetype + ' emerges.');
  }

  if (intensified) {
    synthLines.push('');
    synthLines.push('‚ö° These forces amplify each other.');
    synthLines.push('The pattern runs deep.');
  }

  var closingQ = c[2].reflections[Math.floor(Math.random() * c[2].reflections.length)];

  return { lines: synthLines.join('\n'), question: closingQ };
}

function showReading() {
  var container = document.getElementById('reading-container');
  container.innerHTML = '';

  var positions = [
    { label: 'I ‚Äî ACTIVE ARCHETYPE' },
    { label: 'II ‚Äî SHADOW / CHALLENGE' },
    { label: 'III ‚Äî EMERGING POTENTIAL' }
  ];

  for (var i = 0; i < 3; i++) {
    var card = ARCANA[drawnCards[i]];
    var pos = positions[i];
    var reflection = card.reflections[Math.floor(Math.random() * card.reflections.length)];

    var box = document.createElement('div');
    box.className = 'text-box card-reading';
    box.style.animationDelay = (0.2 + i * 0.5) + 's';
    box.innerHTML =
      '<div class="tb-position">' + pos.label + '</div>' +
      '<div class="tb-card-name">' + card.name + '</div>' +
      '<div class="tb-numeral">' + card.numeral + ' ‚Äî ' + card.archetype + '</div>' +
      '<div class="tb-divider"></div>' +
      '<div class="tb-light">' + card.light16 + '</div>' +
      '<div class="tb-shadow">Shadow: ' + card.shadow16 + '</div>' +
      '<div class="tb-reflection">' + reflection + '</div>';
    container.appendChild(box);
  }

  var synth = generateSynthesis(drawnCards);
  var synthBox = document.createElement('div');
  synthBox.className = 'text-box synthesis-box';
  synthBox.style.animationDelay = '1.8s';
  synthBox.innerHTML =
    '<div class="synth-title">‚ú¶ SYNTHESIS ‚ú¶</div>' +
    '<div class="synth-text">' + synth.lines.replace(/\n/g, '<br>') + '</div>' +
    '<div class="synth-question">' + synth.question + '</div>';
  container.appendChild(synthBox);

  var btn = document.createElement('button');
  btn.className = 'again-btn';
  btn.textContent = '‚Ü∫  DRAW AGAIN';
  btn.onclick = beginReading;
  container.appendChild(btn);

  switchScreen('reading-screen');
  document.getElementById('reading-screen').scrollTop = 0;
}
</script>
</body>
</html>
